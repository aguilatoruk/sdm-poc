CREATE TABLE sod_onehouse.item_dim (
  item_id STRING COMMENT 'A unique system assigned identifier for the retailers SKU.',
  item_name STRING COMMENT 'The name by which the Item is known.',
  item_sku_num STRING COMMENT 'This is the Item SKU Internal Number with verification code.',
  hier_set_cd STRING COMMENT 'This is the Code for the First Level of the Hierarchy named SET (Conjunto).',
  hier_set_name STRING COMMENT 'This is the Name for the First Level of the Hierarchy named SET (Conjunto).',
  hier_group_cd STRING COMMENT 'This is the Code for the Second Level of the Hierarchy named GROUP (Grupo).',
  hier_group_name STRING COMMENT 'This is the Name for the Second Level of the Hierarchy named GROUP (Grupo).',
  hier_subfamily_cd STRING COMMENT 'This is the Code for the Thrid Level of the Hierarchy named SUBFAMILY (Subfamilia).',
  hier_subfamily_name STRING COMMENT 'This is the Name for the Thrid Level of the Hierarchy named SUBFAMILY (Subfamilia).',
  hier_family_cd STRING COMMENT 'This is the Code for the Forth Level of the Hierarchy named FAMILY (Familia).',
  hier_family_name STRING COMMENT 'This is the Name for the Forth Level of the Hierarchy named FAMILY (Familia).',
  hier_department_cd STRING COMMENT 'This is the Code for the Fifth Level of the Hierarchy named DEPARTMENT (Departamento).',
  hier_department_name STRING COMMENT 'This is the Name for the Fifth Level of the Hierarchy named DEPARTMENT (Departamento).',
  item_status_cd STRING COMMENT 'This is the Code for the Status of the Item',
  item_status_desc STRING COMMENT 'This is the Description for the Status of the Item',
  origin_val STRING COMMENT 'Origin of the product, either Imported or National.',
  item_brand_name STRING COMMENT 'The name items brand.',
  item_area_cd STRING COMMENT 'The area is a sub category used specifically at Imperial which specifies the area in which the product is part.',
  item_classification_type_cd STRING COMMENT 'This classifies the availability of the item.',
  item_sales_type_cd STRING COMMENT 'The sales type defines if the item is a product or a service.',
  vendor_id STRING COMMENT 'This is the id of the Vendor',
  job_id STRING COMMENT 'Operational field used to keep track of the record loading',
  brand_cd STRING COMMENT 'The brand code of the item',
  brand_num STRING COMMENT 'The brand number of the item',
  brand_desc STRING COMMENT 'The brand description of the item'
)
PARTITIONED BY (
  country_id STRING COMMENT 'This is the country code in format ISO3.  Example CL, AR, PE, CO, UR.', 
  business_unit_id STRING COMMENT 'A unique retailer assigned identifier for an RetailStore, DistributionCenter or AdministrationCenter'
)
 COMMENT 'Dimensional entity that identifies and describes ITEMS for sales and operational analysis.'
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
WITH SERDEPROPERTIES ('field.delim'='|', 'serialization.format'='|')
STORED AS PARQUET
LOCATION 'hdfs://falabellatam01/ambiente1/pro/rtl/sod/cp/cor/exp/SOD_ONEHOUSE/Item_Dim'
TBLPROPERTIES ('last_modified_by'='hive', 'last_modified_time'='1540858179', 'parquet.compression'='SNAPPY', 'spark.sql.sources.schema.numPartCols'='2', 'spark.sql.sources.schema.numParts'='2', 'spark.sql.sources.schema.part.0'='{\"type\":\"struct\",\"fields\":[{\"name\":\"item_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"A unique system assigned identifier for the retailers SKU.\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"item_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"The name by which the Item is known.\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"item_sku_num\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Item SKU Internal Number with verification code.\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"hier_set_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Code for the First Level of the Hierarchy named SET (Conjunto).\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"hier_set_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Name for the First Level of the Hierarchy named SET (Conjunto).\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"hier_group_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Code for the Second Level of the Hierarchy named GROUP (Grupo).\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"hier_group_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Name for the Second Level of the Hierarchy named GROUP (Grupo).\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"hier_subfamily_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Code for the Thrid Level of the Hierarchy named SUBFAMILY (Subfamilia).\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"hier_subfamily_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Name for the Thrid Level of the Hierarchy named SUBFAMILY (Subfamilia).\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"hier_family_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Code for the Forth Level of the Hierarchy named FAMILY (Familia).\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"hier_family_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Name for the Forth Level of the Hierarchy named FAMILY (Familia).\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"hier_department_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Code for the Fifth Level of the Hierarchy named DEPARTMENT (Departamento).\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"hier_department_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Name for the Fifth Level of the Hierarchy named DEPARTMENT (Departamento).\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"item_status_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Code for the Status of the Item\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"item_status_desc\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the Description for the Status of the Item\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"origin_val\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"Origin of the product, either Imported or National.\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"item_brand_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"The name items brand.\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"item_area_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"The area is a sub category used specifically at Imperial which specifies the area in which the product is part.\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"item_classification_type_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This classifies the availability of the item.\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"item_sales_type_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"The sales type defines if the item is a product or a service.\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"vendor_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the id of the Vendor\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"job_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"Operational field used to keep track of the record loading\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"brand_cd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"The brand code of ', 'spark.sql.sources.schema.part.1'='the item\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"brand_num\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"The brand number of the item\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"brand_desc\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"The brand description of the item\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"country_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"This is the country code in format ISO3.  Example CL, AR, PE, CO, UR.\",\"HIVE_TYPE_STRING\":\"string\"}},{\"name\":\"business_unit_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{\"comment\":\"A unique retailer assigned identifier for an RetailStore, DistributionCenter or AdministrationCenter\",\"HIVE_TYPE_STRING\":\"string\"}}]}', 'spark.sql.sources.schema.partCol.0'='country_id', 'spark.sql.sources.schema.partCol.1'='business_unit_id')	
