CREATE TABLE sod_onehouse.margin_fact (
  item_id STRING COMMENT 'A unique system assigned identifier for the retailers SKU.',
  location_id INT COMMENT 'A unique system assigned identifier for the Location.',
  margin_type_cd STRING COMMENT 'Code of the margin type.',
  sales_return_type_cd STRING COMMENT 'Code of the type of document loaded in Sales/Return. Options are:blta: Boleta fctr: Factura ntcr: Nota Credito ntdb: Nota Debido cdbo: Cargo Descuento Boleta cdft: Cargo Descuento Factura cdnc: Cargo Descuento Nota Credito cdnd: Cargo Descuento Nota Debito',
  sales_return_document_num STRING COMMENT 'Stores the value of the legal document number generated by the sale/return transaction.',
  channel_sales_flg STRING COMMENT 'The second level of the sales hierarchy. Possible values are: VEC: Venta Empresa Clientes. VES: Venta Empresa Subcanal. VSR: Venta Store Retail. VNSR: Venta Non Store Retail',
  sub_channel_level1_sales_flg STRING COMMENT 'Third level of the sales hierarchy. Possible values are: VK: Venta Kiosko. VDVD: Venta DVD',
  sub_channel_level2_sales_flg STRING COMMENT 'Forth Level of the sales hierarchy. Possible values are: VAT: VAT. UX+: UXPOS+. UXC: UXPOS Cotizaciones. SSEE: Servicios Especiales. APP: Mobile App. CALL: Call Center. WEB: Web',
  sub_channel_level3_sales_flg STRING COMMENT 'Fifth and last level of the sales hierarchy. Possible values are: VATT: VAT Tienda. VATI: VAT Internet. WEBM: Web Mobile. WEBD: Web Desktop.',
  business_area_sales_flg STRING COMMENT 'Highest level of the sales hierarchy flag. The possible values are: VE: Venta Empresa. VR: Venta Retail. ',
  margin_pct DECIMAL(18,4) COMMENT 'Margin Percent',
  contribution_amt DECIMAL(20,4) COMMENT 'Contribution amount, it corresponds to Sales-Tax-Cost',
  sales_amt DECIMAL(20,4) COMMENT 'The sales amount',
  tax_amt DECIMAL(20,4) COMMENT 'The Tax amount',
  cost_amt DECIMAL(20,4) COMMENT 'The Cost Amount',
  unit_cnt INT COMMENT 'Unit count',
  major_report_cd STRING COMMENT 'Major Report Code defines the high level of the inventory transaction, such as SS-Sales.',
  minor_report_cd STRING COMMENT 'Minor Report Code defines the source level of the inventory transaction, such as Boleta or Factura.',
  inventory_transaction_type_cd STRING COMMENT 'Code of the Inventory Transaction Type',
  inventory_transaction_type_desc STRING COMMENT 'Description of the Inventory Transaction Type',
  margin_dt STRING COMMENT 'Date of the margin calculations.',
  job_id STRING COMMENT 'Operational field used to keep track of the record loading',
  st_sales_amt DECIMAL(20,4) COMMENT 'Standard coulumn to store the sales without taxes independent of the country that informs it.'
)
PARTITIONED BY (
  country_id STRING COMMENT 'This is the country code in format ISO3.Example CL, AR, PE, CO, UR.', 
  business_unit_id STRING COMMENT 'A unique retailer assigned identifier for an RetailStore, DistributionCenter or AdministrationCenter', 
  transaction_dt STRING COMMENT 'The date where the data was created in the source'
)
 COMMENT 'Fact table that holds the companys margin.It is detailed at SKU-Location-Day level.'
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
WITH SERDEPROPERTIES ('field.delim'='|', 'serialization.format'='|')
STORED AS PARQUET
LOCATION 'hdfs://falabellatam01/ambiente1/pro/rtl/sod/cp/cor/exp/SOD_ONEHOUSE/margin_fact'
TBLPROPERTIES ('last_modified_by'='hive', 'last_modified_time'='1533174689', 'parquet.compression'='SNAPPY')	
