CREATE TABLE sod_onehouse.tender_fact (
  location_id INT COMMENT 'A unique system assigned identifier for the Location.',
  sales_return_document_num STRING COMMENT 'Stores the value of the legal document number generated by the sale/return transaction.',
  retail_trans_line_item_seq_num SMALLINT COMMENT 'The sequence number of line item within the context of this RetailTransaction.',
  adjudication_cd STRING COMMENT 'A code to denote that approval has been received from the authorization center.',
  check_account_num STRING COMMENT 'The check account number of CUSTOMERs whose checks have been previously honored or rejected. Retaining a check history by CUSTOMER provides the RETAIL STORE with a means of tender authorization.',
  check_card_num STRING COMMENT 'The number from a bank issued card guranteeing checks up to a certain value.',
  customer_id STRING COMMENT 'A unique system assigned identifier for the Customer.',
  credit_debit_card_num STRING COMMENT 'Number of the Card used in the purchase transaction',
  transbank_card_num STRING COMMENT 'Transbank card number.  If a giftcard was used, then the value of the giftcard will appear here.',
  gift_certificate_activation_cd STRING COMMENT 'Giftcard activation code',
  gift_certificate_authorization_cd STRING COMMENT 'Giftcard authorization code',
  deferred_payment_cnt SMALLINT COMMENT 'The count of deferred months/installments  of the payments.',
  payment_method_type_cd STRING COMMENT 'Code of the payment method used in the transaction.',
  payment_amt DECIMAL(20,4) COMMENT 'Paid amount according to the payment method.',
  payment_installment_cnt SMALLINT COMMENT 'The count of installements used in the payment transaction.',
  payment_document_scan_flg STRING COMMENT 'Flag used to identify the payments which documents where scanned.',
  risk_entity_answer_val STRING COMMENT 'If a document was validated with the RiskEntity, the return value will be here. For Chile, the risk entity is called DICOM.',
  customer_debt_amt DECIMAL(20,4) COMMENT 'The debt portfolio amount of the customer.',
  origin_credit_note_num STRING COMMENT 'Origin Credit/Debit note number.',
  bank_authorization_cd INT COMMENT 'Bank Authorization code',
  bank_id INT COMMENT 'The bank id',
  buyer_usd_conversion_amt DECIMAL(20,4) COMMENT 'Buyers conversion rate for USD',
  buyer_usd_conversion_rate DECIMAL(12,4) COMMENT 'Buyers conversion rate for Euro',
  customer_identification_type_cd SMALLINT COMMENT 'Code of the customer identification type.',
  discount_cupon_amt DECIMAL(20,4) COMMENT 'The amount of the discount cupon used',
  discount_cupon_cd INT COMMENT 'The code of the discount cupon used',
  discount_cupon_num DECIMAL(12,0) COMMENT 'The number of the discount cupon used',
  financial_surcharge_amt DECIMAL(20,4) COMMENT 'A financial surcharge amount when CMR and banking cards are used.',
  financial_surcharge_rate DECIMAL(12,4) COMMENT 'A financial surcharge rate when CMR and banking cards are used.',
  local_currency_usd_conversion_rate DECIMAL(12,4) COMMENT 'Local currency exchange rate to USD',
  sales_doc_prefix_num STRING COMMENT 'For Uruguay, the document number has an alphanumeric prefix which is contained in this field.',
  job_id STRING COMMENT 'Operational field used to keep track of the record loading',
  till_id INT COMMENT 'The unique identifier for the tender repository'
)
PARTITIONED BY (
  country_id STRING COMMENT 'This is the country code in format ISO3.  Example CL, AR, PE, CO, UR.', 
  business_unit_id STRING COMMENT 'A unique retailer assigned identifier for an RetailStore, DistributionCenter or AdministrationCenter', 
  sales_return_type_cd STRING COMMENT 'Code of the type of document loaded in Sales/Return. Options are: blta: Boleta. fctr: Factura. ntcr: Nota Credito. ntdb: Nota Debido. cdbo: Cargo Descuento Boleta. cdft: Cargo Descuento Factura. cdnc: Cargo Descuento Nota Credito. cdnd: Cargo Descuento Nota Debito.', 
  sales_return_dt STRING COMMENT 'Date in which the sale/return occured.'
)
 COMMENT 'This table reflects tender line item details used in analyzing customer payment habits and patterns.  It is based on retail transaction tender line items and allows retailers to analyze customer payment preferences.'
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
WITH SERDEPROPERTIES ('field.delim'='|', 'serialization.format'='|')
STORED AS PARQUET
LOCATION 'hdfs://falabellatam01/ambiente1/pro/rtl/sod/cp/cor/exp/SOD_ONEHOUSE/tender_fact'
TBLPROPERTIES ('last_modified_by'='hive', 'last_modified_time'='1540858180')	
